![Для чего нужен атрибут `key` при рендере списков?](https://youtu.be/yvOXvZ8aEFo?t=526)

#### Ответ

![[Pasted image 20230704174130.png|600]]

##### Что такое атрибут `key` и для чего он используется?

*Каждому JSX элементу в массиве нужно уникальное свойство `key`*.
*React использует `key` , чтобы механизм Virtual DOM `reconciliation` мог эффективно сравнивать элементы при обновлении.* 

Когда у дочерних элементов есть ключи, React воспользуется ими, чтобы сопоставить потомков исходного дерева с потомками последующего дерева. Например, если добавить `key` к неэффективному примеру выше, преобразование дерева станет эффективнее:

```jsx
<ul>
  <li key="2015">Санкт-Петербург</li>
  <li key="2016">Москва</li>
</ul>

<ul>
  <li key="2014">Ростов-на-Дону</li>
  <li key="2015">Санкт-Петербург</li>
  <li key="2016">Москва</li>
</ul>
```

Теперь React знает, что элемент с ключом `'2014'` — новый, а элементы с ключами `'2015'` и `'2016'` переместились.

*Не стоит делать ключи из индексов массива.* На практике найти ключ обычно несложно. Элемент, который вы хотите отобразить, уже может иметь уникальный идентификатор, и ключ может быть взят из ваших данных:

```jsx
<li key={item.id}>{item.name}</li>
```

Когда уникальное значение отсутствует, вы можете добавить новое свойство идентификатора в вашу модель или прохешировать данные, чтобы сгенерировать ключ. *Ключ должен быть уникальным только среди его соседей, а не глобально.*

*В крайнем случае вы можете передать индекс элемента массива в качестве ключа. Это работает хорошо в случае, если элементы никогда не меняют порядок. Перестановки элементов вызывают замедление.*

Вдобавок перестановки элементов могут вызвать проблемы с состоянием компонента, когда в качестве ключей используются индексы. Экземпляры компонента обновляются и повторно используются на основе своих ключей. Если ключ является индексом, то перемещение элемента изменяет его. В результате состояние компонента для таких элементов, как неуправляемые `<input>`, может смешаться и обновиться неожиданным образом.

*`key` может быть добавлен к абсолютно любому компоненту для того, чтобы сбросить нежелательное состояние этого компонента.*

```jsx
function App() {
  const [activeNote, setActiveNote] = useState();

  const handleClick = (note) => {
    setActiveNote(note);
  };

  return (
    <div className="notes-container">
      <NotesList notes={notes} onClick={handleClick} />
      <Note title={activeNote?.title} key={activeNote?.id} />
    </div>
  );
}
```

Проп `key` помогает React идентифицировать компонент. Его также можно использовать, чтобы сообщить React, что идентификатор компонента изменился и это вызовет полное повторное создание этого компонента. Добавим `key={activeNote?.id}` к компоненту `<Note />`.

```javascript
// ...
  return (
    <div className="notes-container">
      <NotesList notes={notes} onClick={handleClick} />
      <Note title={activeNote?.title} key={activeNote?.id} />
    </div>
  );
}
```

Теперь, при изменении `key` React пересоздаст компонент `<Note />`.

Подробнее: [Ключи](https://ru.react.js.org/docs/lists-and-keys.html#%D0%9A%D0%BB%D1%8E%D1%87%D0%B8) , [Проп key для пересоздания компонента в ReactJS](https://it-dev-journal.ru/articles/prop-key-dlya-peresozdaniya-komponenta-v-react-js)

##### `useId()`

![](https://www.youtube.com/watch?v=GNVI9Pr_RKQ&t=55s)

**`useId`** - это хук *для генерации уникальных идентификаторов*, которые могут быть переданы атрибутам доступности.

```jsx
const id = useId();
```

Подробнее: [useId()](https://reactdev.ru/reference/useId/#_8)

____
#React #key #VirtualDOM #reconciliation #useId

____

#### [[004 React + Redux|Назад]]