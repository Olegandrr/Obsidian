![[web_solution.png|200]]

### Вопросы

___
___
[Webpack interview questions](https://github.com/styopdev/webpack-interview-questions)

### Сборщик веб-приложений
#### `Webpack`

* [Полный обзор webpack](https://habr.com/ru/companies/piter/articles/710844/)
* [[001 Как работает Webpack|Как работает Webpack? Какие основные концепции в нем существуют?]]
* [[002 Какие основные задачи выполняет Webpack при сборке проекта|Какие основные задачи выполняет Webpack при сборке проекта?]]
* [[003 Зависимости для разработки|Какие зависимости для разработки ты знаешь? Что такое `dependencies` и `devDependencies`?]]
* [[004 Что такое бандл (bundle)|Что такое бандл (`bundle`)? Как он используется во Frontend разработке?]]
* [[005 Почему файлы bundle.js имеют разные хеши|Почему файлы `bundle.js` имеют разные хеши?]]
* [[006 Как уменьшить размер `build`. `Production mode`|Как уменьшить размер `bundle.js` ? Что такое `Production mode` ?]]
* [[007 Как уменьшить размер bundle.js. Сжатие с использованием gZip|Как уменьшить размер `bundle.js` ? Сжатие с использованием `gZip`]]
* [[008 Анализ `bundle.js`|Анализ `bundle.js`]]
* [[009 Что такое чанк|Что такое чанк?]]
* [[010 Как создаются чанки|Как создаются чанки?]]
* [[011 Для чего разделяют `bundle.js` на чанки|Для чего разделяют `bundle.js` на чанки?]]
* [[012 Что такое tree shaking|Что такое `tree shaking`?]]
* [[013 Что такое статический анализ кода|Что такое статический анализ кода?]]
* [[014 Что такое Source maps|Что такое `Source maps`?]]
* [Уменьшение размеров бандлов с помощью Webpack Analyzer и React Lazy/Suspense](https://habr.com/ru/companies/ruvds/articles/468225/)

#### `ViteJS`

* [[Обзор ViteJS|Что такое ViteJS?]]

### Архитектура

* [`Webpack` - Module Federation - Официальный сайт](https://webpack.js.org/concepts/module-federation/)

* [[001 Как построить хорошую архитектуру React-проекта|Как построить хорошую архитектуру React-проекта?]]
* [[002 Проблемы монолитной архитектуры|Описание проблем монолитной архитектуры]]
* **[[003 Что такое микросервисы|Что такое `микросервисы`?Какие проблемы решает микросервисная архитектура?]]**
* [[004 Что такое микрофронтенд|Что такое микрофронтенд?]]
* [[005 Микрофронтенд|Подробнее про микрофронтенд]]
* [[006 Плюсы и минусы монолитной и микросервисной архитектур|Плюсы и минусы `монолитной` и `микросервисной` архитектур?]]
* [[007 Разница между монолитной и микросервисной архитектурами|Разница между `монолитной` и `микросервисной` архитектурами?]]
* [[008 Описание `Module Federation`|Описание `Module Federation`]]
* [[009 Архитектура `Module Federation`|Архитектура `Module Federation`]]
* [[010 Проблемы `Module Federation`|Проблемы `Module Federation`]]
* [[Как создать host Application|Как создать `Host Application?`]]



* [[Как создать `remote` APP|Как создать `remote Application`?]]
* [[Разработка микрофронтенд архитектуры|Какие подходы к разработке микрофронтенд архитектуре ты знаешь*]]
* [[Взаимосвязь микрофронтенд приложений|Как взаимосвязаны микрофронтенд приложения?]]
* [[Wrapping микрофронтенд-приложения|Что такое wrapping микрофронтенд-приложения?]]
* [[Асинхронная загрузка]]
* [[Обработка ошибок]]
* [[Настройка сервера]]
* [[Функции совместного использования]]
* [[Терминология]]
* [[Настройки разделительной тележки]]
* [[Совместное состояние]]
* [[Совместное использование JWT]]
* [[Совместное использование корзины]]
* [[Альтернативы совместного использования состояний]]
* [[Достраиваю тележку]]
* [[Кроссплатформенные микро-интерфейсы]]
* [[Маршрутизация микро-интерфейса]]
* [[Unit Testing]]
* [[Сквозное тестирование]]

Создаём host и ремоут веб-приложения.

* одинаковые библиотеки и пакет
* единый ci/cd
* webpack 5

![[Pasted image 20231004004740.png|600]]

обьявляем плагин в вебпаке
`name` - название микрофронтенда
`filename` - файл, куда все будет компонноваться
`library` - формат, в который будем упаковывать
`exposes` - компоненты, которые вы хотите, чтобы микрофронтенды могли использовать

![[Pasted image 20231004005003.png|600]]

прописываем в `output` куда эти файлики мы хотим загружать

Тоже самое делаем с другим микрофронтом и обьвляем хост.

![[Pasted image 20231004005111.png|600]]

Добавляем скрипт, который будет загружать удаленный микрофронтенд

![[Pasted image 20231004005145.png|600]]

Далее используем стандартный механизм React `lazy()` и оборачиваем всё это дело в `<Suspense />`

![[Pasted image 20231004005254.png|600]]

### Как добавить микрофронтенды?

Второй вариант добавления, использовать способность `Module Federation` для автоматической подгрузки:

![[Pasted image 20231004005432.png|600]]

Как это выглядит в браузере?

![[Pasted image 20231004005501.png|600]]

### Что такое `remoteEntry.js` ?

это лоадер чанков, который вы можете делать где угодно и загружать когда угодно.

![[Pasted image 20231004005616.png|600]]

второй способ препочтитетельнее.

### Список распространенных ошибок

1. Не загрузился микрофронтенд при продакш ссборке

![[Pasted image 20231004010100.png|600]]

![[Pasted image 20231004010118.png|600]]

Порезали микрофронтенд на чанки, он упал у нас с ошибкой, тк вебпак не понял, что ему надо использовать.

2. Ошибка в `output` - можем указать не тот `publicPath` и в вашем коде е будет локалхост и итоговый билд не поймет откуда раздавать статику.
	Ошибка в `app-host/webpack.config.ts` 

![[Pasted image 20231004010304.png|600]]

А также наименование в remotes

![[Pasted image 20231004010401.png|600]]

Есть правила нейминга

### Как использовать компоненты

Мы обьявили плагин в нашем микрофронтенде который раздает page, мы обьявили что он раздается по конкретному порту и в апп хосте мы его скачиваем, далее мы реакт коде прописываем что хотим заимпортить его и стилизовать.

Как анимировать компонент
Когда мы задействуем ленивую загрузку - компонент загрузится чуть позже чем отрисуется первый рендер компонента. и соотве. когда мы сделаем анимацию, она в холостую проскочит :
* экспоузить уже с анимацией
* написать самим обертку для React.Lazy

![[Pasted image 20231004010744.png|600]]

Используем обертку

![[Pasted image 20231004010821.png|600]]

Как анимировать переходы между страницами?

* Находим компонент, который мы хотим предгазгрузить *
* Микрофронт => подгружаем
* Микрофронт => Suspense
* Скачался => анимируем
* Навигация => сбрасываем состояние, чтобы страничка могла обновиться

я не хочу скачивать реакт дважды что делать?

![[Pasted image 20231004011107.png|600]]

я хочу пошарить контекст

![[Pasted image 20231004011205.png|600]]

![[Pasted image 20231004011219.png|600]]

![[Pasted image 20231004011236.png|600]]

![[Pasted image 20231004011249.png|600]]

Деплоим

Как обычно деполят?

Собрали наш код, код загнали на веб-сервер или облако и прикрутили ci/cd, но это нам не подойдет пока что.

Нужно обратить внимание:
* Какая у вас инфраструктура
* Нужна ли доступность везде?
* Большая ли нагрузка?

Как деплоят они
Доступность везде - она не нужна - доступно только в россии , cdn нет
где храним статику? - обычное облачное хранилище
ci/cd - docker, чтобы запускать где угодно
webpack dev server - но при продакшене его не используем  , а nginx, он помогает раздавать статику

у нас бекенд - оркестрация - kubernetess

облачное хранилище - файловая система , то что сбилдили загружаем туда
nginx - легковесный и конфиг. инсрумент 
docker - заливаем бандлы в облако и хотим запускать ci/cd на любой машине, он nginx разворачивает
kub...

инфраструктура
cloud storage, // как заливаем файлы? - у нас монорепа и необходимо определить какие микрофронты мы хотим заливать. 
файлы сохраняются в application/octet-stream - svg/png - не отобра
нет multiple upload

Как храним файлы?
![[Pasted image 20231004012045.png]]

![[Pasted image 20231004012058.png]]


Для того чтобы получить файлики осуществляем запрос (пресайн урл)

не умеем в public bucket - свой cdn // pre-sign -url
custom nginx - кастомизация урла
ngx_devel_kit
set-misc
lua-nginx-module

как их добавить
собрать из исходников
скачать из dockerhub
![[Pasted image 20231004012249.png|600]]

Как должно работать?

блок дляобработки апи
обрабатывать запросы на бандлы
обрабатывать маршрутизацию

как выглядит nginx
![[Pasted image 20231004012351.png|600]]


![[Pasted image 20231004012411.png]]


![[Pasted image 20231004012424.png]]










Блок вопросов в разработке.
Ниже прикрепляю полезные ссылки к ознакомлению:
![](https://www.youtube.com/watch?v=lKKsjpH09dU)

* [The Complete Guide to Micro Frontend with React.js for 2022](https://dev.to/devsmitra/the-complete-guide-to-micro-frontend-with-reactjs-for-2022-36b2)
* [Microfrontend. Server fragments — frontend as it supposed to be](https://habr.com/ru/articles/720572/)
* [Микрофронтенды: разделяй и властвуй](https://habr.com/ru/companies/vk/articles/552240/)
* [Микрофронтенды на React и ExtJS](https://habr.com/ru/companies/rostelecom/articles/724512/)
* [Микро-фронтенд. Обзор архитектуры и рекомендуемые практики](https://habr.com/ru/articles/581012/)

