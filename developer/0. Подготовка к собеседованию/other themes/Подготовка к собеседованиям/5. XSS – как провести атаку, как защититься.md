____

tags: #

links: 

youtube: 
1. 

keywords:

_____

XSS — это вид уязвимости, которая свойственна веб-приложениям. Данная атака на сайт состоит в том, что в выдаваемую страницу внедряется вредоносный JavaScript-код. Это становится возможным из-за недостаточной фильтрации данных, полученных от пользователя.

Принцип атаки

1.      На сайте есть форма для публикации сообщения.

2.      Через эту форму хакер вместо простого текста отправляет JS-код.

3.      Сообщение публикуется на странице, которая доступна всем посетителям.

4.      Вредоносный код выполняется для каждого посетителя этой страницы.

5.      Вредоносный скрипт вредит пользователям сайта. Например, крадёт их куки.

Последствия:

**Доступ**  
Одна из главных целей XSS заключается именно в том, чтобы получить cookie жертвы и проникнуть в ее аккаунт. Для этого необходимо найти соответствующую уязвимость, вставить на страницу скрипт отправки cookie на снифер, а затем использовать сграбленные cookie для доступа на нужный сайт.

**Трафик (баннеры, голосования, сплойты и многое другое)**  
XSS используют также и для добычи трафика. Например, с помощью вставки iframe кода связки эксплойтов или даже открытия нового окна со ссылкой.

**Рабочая сила**  
Через хитрые комбинации JavaScript + PHP проводят банальную прогрузку капчи для ее халявной расшифровки юзерами чужого ресурса. Для этого атакованная страница блокируется до тех пор, пока пользователь не введет код с нее.

**CSRF**  
Иногда, даже имея логин и пароль/сессию, хакер не может попасть в аккаунт, так как привязка может быть к ip-адресу, браузеру и другим данным. Поэтому XSS в чистом виде не проходит. Но, зная конструкцию сайта, злоумышленник все равно сможем попасть в аккаунт с помощью межсайтовой подделки запроса.

Защита от XSS атак

ТОП-5 защит от XSS уязвимостей:

**1. Защита функцией htmlspecialchars().**  
Данная функция преобразует переданный ей аргумент в HTML-сущности, причем происходит преобразование именно тех символов, которые являются потенциально небезопасными.

**2. Защита функцией strip_tags().**  
В отличие от htmlspecialchars() данная функция удаляет из строки аргумента только сами теги, причем второй аргумент служит для указания исключений, которые не нужно удалять. Через нее спокойно проходят строки: <, >, < img.

**3. BB-коды.**  
Пропуск только определенных тегов, иногда совсем в иной форме, чем позволяют стандарты HTML

**4. Регулярные выражения.**  
Кто-то регулярки любит, кто-то нет, а кто-то даже предпочитает написать свою собственную, через которую не проходят потенциально опасные символы или теги. Удобно в случае исключения аргументов из внедряемого тега без изменения HTML-сущности оставшейся части.

**5. Самописные функции.**  
Всевозможные рекурсивные парсеры строк, которые очень гибко борются с XSS, также довольно популярны. Хотя в самописных функциях гораздо чаще можно найти какую-либо уязвимость.