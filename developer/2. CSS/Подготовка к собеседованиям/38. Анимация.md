# 38. Анимация

CSS-анимации позволяют анимировать переходы от одной конфигурации CSS стилей к другой. CSS-анимации состоят из двух компонентов: стилевое описание анимации и набор ключевых кадров, определяющих начальное, конечное и, возможно, промежуточное состояние анимируемых стилей.

Есть три преимущества CSS-анимации перед традиционными способами:

1. Простота использования для простых анимаций; вы можете создать анимацию, не зная JavaScript.
2. Анимации будут хорошо работать даже при умеренных нагрузках системы. Простые анимации на JavaScript, если они плохо написаны, часто выполняются плохо. Движок может использовать frame-skipping и другие техники, чтобы сохранить производительность на таком высоком уровне .
3. Позволяет браузеру контролировать последовательность анимации, тем самым оптимизируя производительность и эффективность браузера. Например, уменьшая частоту обновления кадров анимации в непросматриваемых в данный момент вкладках.

[Конфигурирование анимации](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B0%D0%BD%D0%B8%D0%BC%D0%B0%D1%86%D0%B8%D0%B8)

Чтобы создать CSS-анимацию вы должны добавить в стиль элемента, который хотите анимировать, свойство [`animation`](https://developer.mozilla.org/ru/docs/Web/CSS/animation) или его подсвойства. Это позволит вам настроить ускорение и продолжительность анимации, а также другие детали того, как анимация должна протекать. Это не поможет вам настроить внешний вид анимации, который настраивается с помощью [`@keyframes` (en-US)](https://developer.mozilla.org/en-US/docs/Web/CSS/@keyframes "Currently only available in English (US)"), рассматриваемой далее в [Определение последовательности анимации с помощью ключевых кадров](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%B0%D0%BD%D0%B8%D0%BC%D0%B0%D1%86%D0%B8%D0%B8_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%B2%D1%8B%D1%85_%D0%BA%D0%B0%D0%B4%D1%80%D0%BE%D0%B2).

Свойство [`animation`](https://developer.mozilla.org/ru/docs/Web/CSS/animation) имеет следующие подсвойства:

[`animation-name`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-name)

Определяет имя [`@keyframes` (en-US)](https://developer.mozilla.org/en-US/docs/Web/CSS/@keyframes "Currently only available in English (US)"), настраивающего кадры анимации.

[`animation-duration`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-duration)

Определяет время, в течение которого должен пройти один цикл анимации.

[`animation-timing-function`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-timing-function)

Настраивает ускорение анимации.

[`animation-delay`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-delay)

Настраивает задержку между временем загрузки элемента и временем начала анимации.

[`animation-iteration-count`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-iteration-count)

Определяет количество повторений анимации; вы можете использовать значение `infinite` для бесконечного повторения анимации.

[`animation-direction`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-direction)

Даёт возможность при каждом повторе анимации идти по альтернативному пути, либо сбросить все значения и повторить анимацию.

[`animation-fill-mode`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-fill-mode)

Настраивает значения, используемые анимацией, до и после исполнения.

[`animation-play-state`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-play-state)

Позволяет приостановить и возобновить анимацию.

[Определение последовательности анимации с помощью ключевых кадров](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%B0%D0%BD%D0%B8%D0%BC%D0%B0%D1%86%D0%B8%D0%B8_%D1%81_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%B2%D1%8B%D1%85_%D0%BA%D0%B0%D0%B4%D1%80%D0%BE%D0%B2)

После того, как вы настроили временные свойства (продолжительность, ускорение) анимации, вы должны определить внешний вид анимации. Это делается с помощью двух и более ключевых кадров после [`@keyframes` (en-US)](https://developer.mozilla.org/en-US/docs/Web/CSS/@keyframes "Currently only available in English (US)"). Каждый кадр описывает, как должен выглядеть анимированный элемент в текущий момент.

В то время, как временные характеристики (продолжительность анимации) указываются в стилях для анимируемого элемента, ключевые кадры используют [`percentage`](https://developer.mozilla.org/ru/docs/Web/CSS/percentage), чтобы определить стадию протекания анимации. 0% означает начало анимации, а 100% её конец. Так как эти значения очень важны, то для них придумали специальные слова: `from` и `to`.

Вы также можете добавить ключевые кадры, характеризующие промежуточное состояние анимации.

[Примеры](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B)

**Примечание:** **Внимание:** Примеры ниже не используют префиксов для CSS стилей . Webkit-браузеры и старые версии других браузеров нуждаются в указании префиксов в CSS стилях. Примеры, на которые вы можете кликнуть в своём браузере, также содержат префиксы -webkit-.

[Скольжение текста](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5_%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%B0)

Этот простой пример анимирует скольжение текста в элементе [`<p>`](https://developer.mozilla.org/ru/docs/Web/HTML/Element/p) от правого края окна браузера.

Обратите внимание на то, что анимация может сделать страницу шире, чем окно браузера. Этого можно избежать, поместив элемент, который будет анимироваться, в контейнер и установив ему свойство [`overflow`](https://developer.mozilla.org/ru/docs/Web/CSS/overflow)`: hidden`.

p {

```
  
```

```
  
```

}

@keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
    
```

```
    
```

```
  
```

}

Copy to Clipboard

В стиле для элемента [`<p>`](https://developer.mozilla.org/ru/docs/Web/HTML/Element/p) с помощью свойства [`animation-duration`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-duration) указано, что исполнение анимации от начала до конца должно занять 3 с , и что имя для [`@keyframes` (en-US)](https://developer.mozilla.org/en-US/docs/Web/CSS/@keyframes "Currently only available in English (US)"), описывающей саму анимацию, определено как "slidein".

В элемент [`<p>`](https://developer.mozilla.org/ru/docs/Web/HTML/Element/p) можно добавлять и другие пользовательские стили, чтобы как-то украсить его, однако здесь мы хотели продемонстрировать только эффект анимации.

Ключевые кадры определяются с помощью правила [`@keyframes` (en-US)](https://developer.mozilla.org/en-US/docs/Web/CSS/@keyframes "Currently only available in English (US)"). В данном случае мы имеем только два ключевых кадра. Первый при 0% анимации (`from`). Здесь мы придаём элементу левый отступ в 100% и ширину в 300% (в три раза больше ширины родительского элемента). Это становится причиной того, что при первом кадре анимации заголовок [`<p>`](https://developer.mozilla.org/ru/docs/Web/HTML/Element/p) находится за пределами правого края окна браузера .

Второй ключевой кадр (to) определяет конец анимации, т.е (100%). Левый отступ устанавливается равным 0, а ширина 100%. Все выглядит так, будто заголовок [`<p>`](https://developer.mozilla.org/ru/docs/Web/HTML/Element/p) приплывает к левому краю окна браузера.

<p>`The Caterpillar and Alice looked at each other for some time in silence:`

```
at last the Caterpillar took the hookah out of its mouth, and addressed
```

```
her in a languid, sleepy voice.
```

Copy to Clipboard

(Обновите страницу, чтобы увидеть анимацию, или щёлкните по кнопке CodePen, чтобы воспроизвести её в окне CodePen)

[Добавление других ключевых кадров](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D1%85_%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%B2%D1%8B%D1%85_%D0%BA%D0%B0%D0%B4%D1%80%D0%BE%D0%B2)

Давайте добавим другие ключевые кадры в предыдущий пример. Скажем, мы хотим чтобы размер шрифта заголовка временно увеличивался по мере продвижения влево, а потом возвращался к первоначальному значению . Это легко реализовать с помощью следующего ключевого кадра:

75% {

```
  
```

```
  
```

```
  
```

}

Copy to Clipboard

p {

```
  
```

```
  
```

}

@keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
    
```

```
    
```

```
    
```

```
  
```

}

Copy to Clipboard

<p>`The Caterpillar and Alice looked at each other for some time in silence:`

```
at last the Caterpillar took the hookah out of its mouth, and addressed
```

```
her in a languid, sleepy voice.
```

Copy to Clipboard

Это говорит браузеру о том, что при 75% выполнения анимации, шрифт должен быть 300%, а ширина 150%.

(Обновите страницу, чтобы увидеть анимацию, или щёлкните по кнопке CodePen, чтобы воспроизвести её в окне CodePen)

[Настройка повторения](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%BF%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D1%8F)

Чтобы настроить повторение, нужно добавить свойство [`animation-iteration-count`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-iteration-count) и задать ему значение, равное нужному количеству повторений анимаций . В данном случае давайте установим значение `infinite` для бесконечного повторения:

p {

```
  
```

```
  
```

```
  
```

}

Copy to Clipboard

@keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
    
```

```
    
```

```
  
```

}

Copy to Clipboard

<p>`The Caterpillar and Alice looked at each other for some time in silence:`

```
at last the Caterpillar took the hookah out of its mouth, and addressed
```

```
her in a languid, sleepy voice.
```

Copy to Clipboard

[Движение текста вправо и влево](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%B4%D0%B2%D0%B8%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5_%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%B0_%D0%B2%D0%BF%D1%80%D0%B0%D0%B2%D0%BE_%D0%B8_%D0%B2%D0%BB%D0%B5%D0%B2%D0%BE)

Итак, мы настроили повторение, но получили нечто странное: текст при каждом повторении снова "запрыгивает" за край окна браузера. То, чего мы хотим, так это чтобы текст двигался влево и вправо. Этого легко достичь с помощью установки свойству [`animation-direction`](https://developer.mozilla.org/ru/docs/Web/CSS/animation-direction) значения `alternate`:

p {

```
  
```

```
  
```

```
  
```

```
  
```

}

Copy to Clipboard

@keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
    
```

```
    
```

```
  
```

}

Copy to Clipboard

<p>`The Caterpillar and Alice looked at each other for some time in silence:`

```
at last the Caterpillar took the hookah out of its mouth, and addressed
```

```
her in a languid, sleepy voice.
```

Copy to Clipboard

[Использование шорткодов](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%88%D0%BE%D1%80%D1%82%D0%BA%D0%BE%D0%B4%D0%BE%D0%B2)

Шорткод [`animation`](https://developer.mozilla.org/ru/docs/Web/CSS/animation) полезен для экономии места в коде. Например, правило, которое мы используем в этой статье:

p {

```
  
```

```
  
```

```
  
```

```
  
```

}

Copy to Clipboard

можно заменить на:

p {

```
  
```

}

Copy to Clipboard

**Примечание:** **Внимание**: подробнее об этом на странице раздела [`animation`](https://developer.mozilla.org/ru/docs/Web/CSS/animation)

[Установка нескольких значений свойствам анимации](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%B8%D1%85_%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B9_%D1%81%D0%B2%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0%D0%BC_%D0%B0%D0%BD%D0%B8%D0%BC%D0%B0%D1%86%D0%B8%D0%B8)

CSS-свойство анимации может иметь несколько значений, разделённых запятыми. Это используется, чтобы указать несколько значений анимации в одном правиле и установить разную продолжительность, число повторений и т.д., для различных анимаций. Рассмотрим несколько примеров, чтобы увидеть разницу.

В первом примере у свойства имени анимации установлены три значения, у свойств продолжительности и количества повторений — по одному. В этом случае у всех трёх анимаций одинаковая продолжительность и число повторений:

animation-name: `fadeInOut`, `moveLeft300px`, `bounce`;

animation-duration: `3s`;

animation-iteration-count: `1`;

Copy to Clipboard

Во втором примере установлены три значения для каждого из свойств. В этом случае каждая анимация выполняется с соответствующими по порядку значениями в каждом свойстве, так, например, `fadeInOut` имеет продолжительность 2.5 с и количество повторений 2, и т.д.

animation-name: `fadeInOut`, `moveLeft300px`, `bounce`;

animation-duration: `2.5s`, `5s`, `1s`;

animation-iteration-count: `2`, `1`, `5`;

Copy to Clipboard

В третьем примере определены три значения имени анимации, но два значения продолжительности и количества повторений. В случае, когда количества значений недостаточно для каждой анимации, значения берутся циклически от начала до конца. Например, у `fadeInOut` длительность будет 2.5s, а `moveLeft300px` — 5s. Значения продолжительности закончились, теперь они берутся сначала — `bounce` получит продолжительность 2.5s. Значение количества повторений (а также другие указанные свойства) будет определено таким же образом.

animation-name: `fadeInOut`, `moveLeft300px`, `bounce`;

animation-duration: `2.5s`, `5s`;

animation-iteration-count: `2`, `1`;

Copy to Clipboard

[Использование событий анимации](https://developer.mozilla.org/ru/docs/Web/CSS/CSS_Animations/Using_CSS_animations#%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D0%BE%D0%B1%D1%8B%D1%82%D0%B8%D0%B9_%D0%B0%D0%BD%D0%B8%D0%BC%D0%B0%D1%86%D0%B8%D0%B8)

Вы можете получить дополнительный контроль над анимацией, а также полезную информацию о ней, с помощью _событий анимации_. Эти события, представленные объектом [`AnimationEvent` (en-US)](https://developer.mozilla.org/en-US/docs/Web/API/AnimationEvent "Currently only available in English (US)"), можно использовать, чтобы определить, когда начинается и заканчивается анимация или начинается новая итерация. Каждое событие содержит момент времени, когда оно произошло, а также имя анимации, которая вызвала событие.

Мы будем модифицировать текст, чтобы выводить некоторую информацию о каждом событии анимации. Так мы сможем увидеть, как она работает.

Добавление CSS

Начнём с добавления CSS. Анимация будет длиться 3 секунды, будет называться "slidein", будет повторяться 3 раза, а также значение animation-direction установлено alternate. В ключевых кадрах [`@keyframes` (en-US)](https://developer.mozilla.org/en-US/docs/Web/CSS/@keyframes "Currently only available in English (US)") установлены такие значения ширины и левого отступа, что элемент будет скользить по экрану.

.slidein {

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

```
  
```

}

@-moz-keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
    
```

```
    
```

```
  
```

}

@-webkit-keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
   
```

```
   
```

```
 
```

}

@keyframes slidein {

```
  
```

```
    
```

```
    
```

```
  
```

```
  
```

```
   
```

```
   
```

```
 
```

}

Copy to Clipboard

Добавление обработчика события анимации

Будем использовать JavaScript для отслеживания всех трёх возможных событий анимации. Следующий код конфигурирует обработчик; мы вызываем его при первой загрузке документа.

var `e` = `document`.getElementById("watchme");

```
e
```

```
e
```

```
e
```

```
e
```

Copy to Clipboard

Это довольно стандартный код; вы можете получить дополнительную информацию в документации `element.addEventListener()`. Последнее, что делает этот код - это установка класса "slidein" для анимируемого элемента; мы делаем это, чтобы запустить анимацию.

Почему? Потому что в нашем случае событие `animationstart` происходит как только анимация стартует, и это происходит раньше, чем исполняется наш сценарий. Так мы сможем контролировать начало анимации самостоятельно посредством вставки класса "slidein" для анимируемого элемента.

Регистрация событий

События будут передаваться функции `listener()`, показанной ниже.

function listener(e) {

```
  
```

```
  
```

```
    
```

```
      l
```

```
      
```

```
    
```

```
      l
```

```
      
```

```
    
```

```
      l
```

```
      
```

```
  
```

```
  document
```

}

Copy to Clipboard

Этот код также очень прост. Этот код следит за [`event.type`](https://developer.mozilla.org/ru/docs/Web/API/Event/type), чтобы определить тип события, и добавляет элемент [`<ul>`](https://developer.mozilla.org/ru/docs/Web/HTML/Element/ul), чтобы залогировать произошедшее событие.

Вывод, когда анимация закончится, будет выглядеть примерно следующим образом:

- Started: elapsed time is 0
- New loop started at time 3.01200008392334
- New loop started at time 6.00600004196167
- Ended: elapsed time is 9.234000205993652

Обратите внимание, что время, указанное в выводе, и время, которое мы указали в стилях, не совпадают. Также обратите внимание, что после окончания итерации не посылается событие `animationiteration` ; вместо него посылается событие `animationend`.

HTML

Ради полноты картины приведём код разметки HTML. В разметке имеется тег _ul,_ в который и выводится вся информация:

<body>

```
  
```

```
  
```

```
  move across the page.
```

```
  
```

```
  
```

```
  
```

</body>
