# 59. Filter

Следующий метод, который мы рассмотрим является `filter`. Соответствуя своему названию метод берёт массив и фильтрует его, убирая ненужные элементы.

Также как и `map`, `filter` определяется в `Array.prototype`. Метод доступен для любого массива, в качестве первого аргумента передаётся каллбек. `filter` вызывает каллбек для каждого элемента массива, в результате возвращается _новый_ массив, содержащий _только_ элементы, для которых каллбек возвратил `true`.

Также как и `map`, `filter` передаёт каллбеку три аргумента:

1. Текущий элемент
2. Текущий индекс
3. _Массив_, для которого вызывается `filter`

`filter` на практике

Давайте вернёмся к нашему приложению с задачами на день. Вместо того, чтобы получать называния каждой задачи, предположим мне нужен список задач на выполнение которых я потратил два часа.

Используя `forEach`, мы напишем:

|   |   |
|---|---|
|1|**var** difficult_tasks = [];|
|2||
|3|tasks.forEach(**function** (task) {|
|4|**if** (task.duration >= **120**) {|
|5|difficult_tasks.push(task);|
|6|}|
|7|});|

С `filter`:

|   |   |
|---|---|
|1|**var** difficult_tasks = tasks.filter(**function** (task) {|
|2|**return** task.duration >= **120**;|
|3|});|
|4||
|5|// Using ES6|
|6|**var** difficult_tasks = tasks.filter((task) => task.duration >= **120** );|

В коде выше я не использовал аргументы `index` и `array` для нашего каллбека, так как в них нет необходимости.

Также как и `map`, `filter` позволяет нам:

- Избежать мутации массива внутри `forEach` или `for` циклах
- добавить результат новой переменной, вместо передачи значений в новый массив, который мы создали ранее

Подводные камни

Каллбек, который вы передаёте map должен содержать `return`, если вы хотите, чтобы всё работало, так как вы задумали. С `filter`, вы также должны использовать return и _убедиться_, что он возвращает булево значение.

Если забыть о return, каллбек возвратит `undefined`, и результат `filter` всегда будет `false`. Вместо ошибки будет возвращён пустой массив!

В том случае если возвращается что-то отличное от `true` или `false`, тогда `filter` попытается решить что вы пытаетесь получить, согласно [**правилам приведения JavaScript**](https://github.com/getify/You-Dont-Know-JS/blob/master/types%20&%20grammar/ch4.md). Скорее всего вы опять же получите ошибку. И также как и забыв return, ошибка будет на так очевидна.

_Никогда_ не забывайте добавлять return в каллбеки. Также для `filter` значение _всегда_ должно быть `true` или `false`. Это поможет вам сохранить рассудок, в случае ошибок.
